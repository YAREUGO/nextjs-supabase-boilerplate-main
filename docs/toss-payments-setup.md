# Toss Payments 설정 가이드

이 문서는 Toss Payments 테스트 모드 설정 방법을 안내합니다.

## 환경 변수 설정

`.env` 또는 `.env.local` 파일에 다음 환경 변수를 추가하세요:

```bash
# Toss Payments 클라이언트 키 (테스트 모드)
NEXT_PUBLIC_TOSS_CLIENT_KEY=test_ck_D5GePWvyJnrK0W0k6q8gLzN97Eoq
```

**중요**:

- 환경 변수가 설정되지 않은 경우 기본 테스트 키가 사용됩니다.
- 프로덕션 배포 시에는 반드시 환경 변수로 실제 클라이언트 키를 설정하세요.
- 환경 변수는 `.env` 또는 `.env.local` 파일에 설정합니다.

## 테스트 카드 번호

Toss Payments 테스트 모드에서는 다음 테스트 카드 번호를 사용할 수 있습니다:

### 신용카드 결제 테스트

- **카드번호**: 4330123412341234
- **유효기간**: 12/34
- **CVC**: 123
- **비밀번호**: 123456 (간편결제 비밀번호)

### 간편결제 테스트

- **계좌번호**: 12345678901234
- **비밀번호**: 123456

## 결제 플로우

1. **주문 생성**: 사용자가 배송지 정보를 입력하고 주문을 생성합니다.

   - 주문 상태: `pending`
   - 장바구니는 아직 비우지 않음

2. **결제 페이지**: 주문 생성 후 결제 페이지로 이동합니다.

   - Toss Payments 위젯이 표시됩니다.
   - 사용자가 결제 수단을 선택하고 결제를 진행합니다.

3. **결제 성공**: 결제가 성공하면:

   - 주문 상태가 `pending` → `confirmed`로 변경됩니다.
   - 장바구니가 비워집니다.
   - 주문 완료 페이지로 리다이렉트됩니다.

4. **결제 실패**: 결제가 실패하면:
   - 주문 상태가 `cancelled`로 변경됩니다.
   - 결제 실패 페이지로 리다이렉트됩니다.

## 프로덕션 전환 시 주의사항

1. **클라이언트 키 변경**: 테스트 키를 실제 프로덕션 키로 변경하세요.
2. **환경 변수 사용**: 하드코딩된 키를 제거하고 환경 변수를 사용하세요.
3. **결제 검증 강화**: 서버 사이드에서 결제 금액 및 주문 정보를 재검증하세요.
4. **에러 처리**: 더 상세한 에러 로깅 및 모니터링을 추가하세요.

## 문제 해결

### 결제 위젯이 표시되지 않는 경우

1. Toss Payments 클라이언트 키가 올바른지 확인하세요.
2. 브라우저 콘솔에서 에러 메시지를 확인하세요.
3. 네트워크 연결을 확인하세요.

### 결제 승인 실패

1. 주문 상태가 `pending`인지 확인하세요.
2. 결제 금액이 주문 금액과 일치하는지 확인하세요.
3. 서버 로그에서 에러 메시지를 확인하세요.
